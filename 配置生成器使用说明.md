# main.js配置生成器使用说明 - 完整版

## 概述

这些脚本可以帮助您自动生成main.js中需要的各种配置。在网站控制台中运行这些脚本，可以自动检测当前页面的信息并生成相应的配置。

## 脚本文件说明

### 1. 自动生成main.js中基本配置.js
**功能**: 完整的配置生成器，包含所有基本配置项
**特点**: 
- 生成完整的location、navigator、window、document配置
- 提供多种格式的输出（环境变量、命令行参数、JavaScript对象）
- 包含测试代码和验证功能

### 2. 快速获取location配置.js
**功能**: 简化版本，专门用于快速获取location配置
**特点**:
- 轻量级，运行速度快
- 专注于location配置
- 提供基本的配置输出

### 3. main.js配置生成器.js
**功能**: 专门生成main.js中smartConfig的完整配置
**特点**:
- 生成与main.js完全兼容的配置代码
- 包含完整的smartConfig结构
- 提供测试和验证功能

### 4. 高级配置生成器.js - 新增
**功能**: 高级配置生成器，包含更多实用功能和配置项
**特点**:
- 完整的设备检测（移动设备、平板、桌面）
- 详细的浏览器检测（Chrome、Firefox、Safari、Edge等）
- 操作系统检测（Windows、macOS、Linux、Android、iOS）
- 网络类型检测（WiFi、4G、3G、2G）
- 浏览器特性全面检测
- 性能监控和内存使用统计
- 安全上下文和证书信息
- 详细的兼容性报告

### 5. 浏览器兼容性检测器.js - 新增
**功能**: 专门检测浏览器兼容性和特性支持
**特点**:
- ES6+特性检测（箭头函数、模板字符串、解构赋值等）
- Web API支持检测（Fetch、WebGL、Service Worker等）
- CSS特性检测（Flexbox、Grid、动画等）
- 性能特性检测（Performance API、内存使用等）
- 安全特性检测（CSP、HTTPS、证书等）
- 详细的兼容性报告和支持率统计

### 6. 性能监控配置生成器.js - 新增
**功能**: 专门用于性能监控和优化的配置生成器
**特点**:
- 页面加载时间监控
- 内存使用情况监控
- 资源加载统计
- 网络连接质量检测
- 设备性能评估
- 自动生成优化建议
- 性能监控代码生成

### 7. 一键配置生成器.js - 新增
**功能**: 一键式配置生成器，整合所有功能
**特点**:
- 整合所有配置功能
- 自动生成完整配置
- 智能优化建议
- 多种输出格式
- 一键生成所有配置

## 使用方法

### 步骤1: 打开网站控制台
1. 在浏览器中打开目标网站
2. 按F12打开开发者工具
3. 切换到Console（控制台）标签

### 步骤2: 运行配置生成器
选择以下任一方式：

#### 方式1: 使用一键配置生成器（推荐）
```javascript
// 复制 一键配置生成器.js 的内容到控制台并运行
// 包含所有配置功能，最全面
```

#### 方式2: 使用高级配置生成器
```javascript
// 复制 高级配置生成器.js 的内容到控制台并运行
// 包含设备检测、浏览器检测、网络检测等高级功能
```

#### 方式3: 使用兼容性检测器
```javascript
// 复制 浏览器兼容性检测器.js 的内容到控制台并运行
// 专门检测浏览器兼容性和特性支持
```

#### 方式4: 使用性能监控配置生成器
```javascript
// 复制 性能监控配置生成器.js 的内容到控制台并运行
// 专门用于性能监控和优化
```

#### 方式5: 使用简化版本
```javascript
// 如果只需要location配置，使用快速获取location配置.js
```

### 步骤3: 获取配置结果
运行脚本后，您将看到：

1. **当前页面信息**: URL、域名、标题等
2. **设备信息**: 设备类型、浏览器、操作系统等
3. **网络信息**: 网络类型、连接状态等
4. **性能信息**: 页面加载时间、内存使用等
5. **兼容性信息**: 浏览器特性支持情况
6. **main.js配置代码**: 可直接在main.js中使用的代码
7. **环境变量**: 可用于设置环境变量的格式
8. **命令行参数**: 可用于命令行启动的格式
9. **测试代码**: 用于验证配置的代码
10. **优化建议**: 基于检测结果的优化建议

### 步骤4: 使用生成的配置

#### 在main.js中使用
```javascript
// 复制生成的smartConfig配置到main.js中
const smartConfig = {
    location: {
        href: "https://example.com/path",
        protocol: "https:",
        host: "example.com",
        // ... 其他配置
    },
    // ... 其他配置项
};
```

#### 设置环境变量
```bash
# 复制生成的环境变量到您的环境中
export LOCATION_HREF="https://example.com/path"
export LOCATION_HOST="example.com"
# ... 其他环境变量
```

#### 使用命令行参数
```bash
# 使用生成命令行参数启动程序
node main.js --location-href="https://example.com/path" --location-host="example.com"
```

## 配置项说明

### Location配置
- `href`: 完整的URL
- `protocol`: 协议（http:、https:等）
- `host`: 主机名和端口
- `hostname`: 主机名
- `port`: 端口号
- `pathname`: 路径部分
- `search`: 查询字符串
- `hash`: 锚点部分
- `origin`: 源（协议+主机名+端口）

### Navigator配置
- `userAgent`: 用户代理字符串
- `platform`: 平台信息
- `language`: 主要语言
- `languages`: 支持的语言列表
- `hardwareConcurrency`: CPU核心数
- `deviceMemory`: 设备内存
- `cookieEnabled`: Cookie是否启用
- `onLine`: 是否在线

### Window配置
- `innerWidth`: 窗口宽度
- `innerHeight`: 窗口高度
- `devicePixelRatio`: 设备像素比
- `outerWidth`: 外部窗口宽度
- `outerHeight`: 外部窗口高度
- `screenX`: 屏幕X坐标
- `screenY`: 屏幕Y坐标
- `scrollX`: 水平滚动位置
- `scrollY`: 垂直滚动位置

### Document配置
- `title`: 页面标题
- `domain`: 域名
- `characterSet`: 字符编码
- `URL`: 文档URL
- `referrer`: 引用页面
- `lastModified`: 最后修改时间
- `readyState`: 文档就绪状态

### Device配置（新增）
- `isMobile`: 是否为移动设备
- `isTablet`: 是否为平板设备
- `isDesktop`: 是否为桌面设备
- `isChrome`: 是否为Chrome浏览器
- `isFirefox`: 是否为Firefox浏览器
- `isSafari`: 是否为Safari浏览器
- `isEdge`: 是否为Edge浏览器
- `isWindows`: 是否为Windows系统
- `isMac`: 是否为macOS系统
- `isLinux`: 是否为Linux系统
- `isAndroid`: 是否为Android系统
- `isIOS`: 是否为iOS系统

### Screen配置（新增）
- `width`: 屏幕宽度
- `height`: 屏幕高度
- `availWidth`: 可用宽度
- `availHeight`: 可用高度
- `colorDepth`: 颜色深度
- `pixelDepth`: 像素深度

### Network配置（新增）
- `onLine`: 是否在线
- `effectiveType`: 网络类型（4g、3g、2g、slow-2g）
- `downlink`: 下行速度
- `rtt`: 往返时间

### BrowserFeatures配置（新增）
- `localStorage`: 本地存储支持
- `sessionStorage`: 会话存储支持
- `indexedDB`: IndexedDB支持
- `serviceWorker`: Service Worker支持
- `webGL`: WebGL支持
- `webGL2`: WebGL2支持
- `touch`: 触摸支持
- `geolocation`: 地理位置支持
- `notifications`: 通知支持
- `webWorker`: Web Worker支持
- `webSocket`: WebSocket支持

### Performance配置（新增）
- `timing`: 性能计时信息
- `memory`: 内存使用信息
- `navigation`: 导航信息
- `metrics`: 性能指标

### Security配置（新增）
- `isSecureContext`: 是否为安全上下文
- `origin`: 源信息
- `protocol`: 协议信息
- `hostname`: 主机名信息

## 全局变量

运行脚本后，配置会保存到以下全局变量：

### window.allConfigs (一键配置生成器)
```javascript
window.allConfigs = {
    config: {}, // 完整配置
    mainJS: "", // main.js配置代码
    envVars: {}, // 环境变量
    report: {}, // 配置报告
    test: "", // 测试代码
    suggestions: [] // 优化建议
};
```

### window.advancedConfig (高级配置生成器)
```javascript
window.advancedConfig = {
    config: {}, // 完整配置
    mainJS: "", // main.js配置代码
    envVars: {}, // 环境变量
    report: {}, // 详细报告
    test: "" // 测试代码
};
```

### window.compatibilityReport (兼容性检测器)
```javascript
window.compatibilityReport = {
    report: {}, // 兼容性报告
    test: "" // 测试代码
};
```

### window.performanceConfig (性能监控配置生成器)
```javascript
window.performanceConfig = {
    config: {}, // 性能配置
    monitoringCode: "", // 监控代码
    suggestions: [], // 优化建议
    test: "" // 测试代码
};
```

### window.autoGeneratedConfig (基本配置生成器)
```javascript
window.autoGeneratedConfig = {
    current: {}, // 当前配置
    env: {}, // 环境变量
    args: [], // 命令行参数
    js: {}, // JavaScript对象
    mainJS: "", // main.js配置代码
    test: "" // 测试代码
};
```

### window.locationConfig (简化版本)
```javascript
window.locationConfig = {
    current: {}, // 当前location配置
    mainJS: "", // main.js配置代码
    envVars: [], // 环境变量
    cmdArgs: [] // 命令行参数
};
```

### window.mainJSConfig (main.js版本)
```javascript
window.mainJSConfig = {
    config: {}, // 完整配置
    mainJS: "", // main.js配置代码
    env: {}, // 环境变量
    test: "" // 测试代码
};
```

## 使用示例

### 示例1: 获取完整配置
```javascript
// 运行一键配置生成器后
console.log(window.allConfigs.config);
```

### 示例2: 复制main.js配置代码
```javascript
// 复制生成的配置代码
console.log(window.allConfigs.mainJS);
```

### 示例3: 运行测试
```javascript
// 验证配置是否正确
eval(window.allConfigs.test);
```

### 示例4: 查看优化建议
```javascript
// 查看优化建议
console.log(window.allConfigs.suggestions);
```

### 示例5: 查看兼容性报告
```javascript
// 运行兼容性检测器后
console.log(window.compatibilityReport.report);
console.log('ES6支持率:', window.compatibilityReport.report.es6.support.rate + '%');
```

### 示例6: 查看性能监控
```javascript
// 运行性能监控配置生成器后
console.log(window.performanceConfig.config);
console.log('页面加载时间:', window.performanceConfig.config.metrics.timing.pageLoadTime + 'ms');
```

### 示例7: 设置环境变量
```javascript
// 获取环境变量格式
Object.entries(window.allConfigs.envVars).forEach(([key, value]) => {
    console.log(`${key}=${value}`);
});
```

## 新增功能特性

### 1. 设备检测
- 自动检测设备类型（移动设备、平板、桌面）
- 识别浏览器类型和版本
- 检测操作系统和架构
- 识别渲染引擎

### 2. 网络检测
- 检测网络连接状态
- 推测网络类型（WiFi、4G、3G、2G）
- 获取连接质量信息

### 3. 性能监控
- 页面加载时间统计
- 内存使用情况监控
- 性能指标收集
- 资源加载分析

### 4. 安全检测
- 安全上下文检测
- HTTPS证书验证
- 内容安全策略检测

### 5. 兼容性检测
- ES6+特性支持检测
- Web API支持检测
- CSS特性支持检测
- 性能特性支持检测
- 安全特性支持检测

### 6. 智能优化建议
- 基于设备类型的建议
- 基于网络类型的建议
- 基于性能的建议
- 基于兼容性的建议

## 注意事项

1. **浏览器环境**: 这些脚本需要在浏览器环境中运行
2. **安全限制**: 某些网站可能有CSP限制，可能无法运行脚本
3. **动态内容**: 如果页面有动态加载的内容，建议等待页面完全加载后再运行脚本
4. **隐私信息**: 脚本会获取当前页面的信息，请注意隐私保护
5. **性能影响**: 高级配置生成器可能会对页面性能产生轻微影响
6. **兼容性**: 某些新特性可能在旧浏览器中不支持

## 故障排除

### 问题1: 脚本无法运行
**解决方案**: 检查是否在浏览器控制台中运行，确保没有语法错误

### 问题2: 配置不完整
**解决方案**: 确保页面完全加载后再运行脚本

### 问题3: 环境变量格式错误
**解决方案**: 检查生成的URL是否包含特殊字符，可能需要转义

### 问题4: 兼容性检测失败
**解决方案**: 某些特性检测可能在某些浏览器中失败，这是正常现象

### 问题5: 性能监控数据不准确
**解决方案**: 确保在页面完全加载后运行脚本，以获得准确的性能数据

## 更新日志

- v1.0: 初始版本，支持基本的location配置生成
- v1.1: 添加了完整的smartConfig配置生成
- v1.2: 增加了测试代码和验证功能
- v1.3: 优化了输出格式，增加了多种配置格式支持
- v2.0: 新增高级配置生成器，包含设备检测、网络检测等功能
- v2.1: 新增浏览器兼容性检测器，支持ES6、Web API、CSS等特性检测
- v2.2: 新增性能监控配置生成器，支持性能监控和优化建议
- v2.3: 新增一键配置生成器，整合所有功能
- v2.4: 增强智能优化建议和兼容性检测功能 